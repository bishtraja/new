name: GitHub Actions Demo
on: 
  workflow_dispatch:
jobs:
  sending-email:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
        
      - name: kubeconfig set
        shell: bash
        run: |
          aws eks update-kubeconfig --name ${{ env.QA_CLUSTER_NAME }} --region ${{ env.AWS_REGION }}
          kubectl get po -n bp-qa
          
      - name: Send email
        if: ${{ always() }}
        uses: dawidd6/action-send-mail@v3.6.0
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: vijaybishtrkt
          password: ${{secrets.APPPASSWD}}
          subject: Message from github actions.
          to: vijaybisht0103@gmail.com,vijay.bisht@opstree.com
          from: vijaybishtrkt@gmail.com
          secure: true
          body: workflow for ${{github.repository}} is ${{job.status}}!
